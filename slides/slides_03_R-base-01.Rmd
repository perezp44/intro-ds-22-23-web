---
title: "R-base: algunas ideas b√°sicas"
subtitle: "Programaci√≥n y manejo de datos con R (Slides 03)"  
author: 
  - "Pedro J. P√©rez"
  #- "2020, septiembre"
date: "(actualizadas en `r Sys.Date()`)"
output:
  xaringan::moon_reader:
    self_contained: true
    seal: false   #- puedes tunear la primera p√°gina de las slides    
    lib_dir: libs
    css: 
      - ../assets/xaringan-themer.css
      - ../assets/my_css_file_xaringan_verdes.css  #- good (funciona lo de justify)
    nature:
      highlightStyle: github  #- solarized-light ; googlecode
      highlightLines: true
      highlightLanguage: ["r"]
      countIncrementalSlides: false
      ratio: "16:9"
    includes:
      #after_body: [css/insert-logo.html]
      in_header: 
        - !expr here::here("assets", "favicon-yo.html") 
        #- !expr here::here("assets", "google-analytics.html") 
#      in_header: ["favicon-yo.html", "google-analytics.html"]
---


```{r xaringan-extra, include = FALSE}
xaringanExtra::use_xaringan_extra(c("tile_view", "logo", "tachyons", "animate_css", "scribble"))
#xaringanExtra::use_share_again()
xaringanExtra::use_clipboard()
xaringanExtra::use_fit_screen()
xaringanExtra::use_tile_view()
xaringanExtra::use_tachyons()
xaringanExtra::use_extra_styles(hover_code_line = TRUE, mute_unhighlighted_code = FALSE)
xaringanExtra::use_panelset()
```

```{r xaringan-themer, include = FALSE, warning = FALSE}
library(xaringanthemer)
style_mono_light(
  base_color = "#1c5253", 
  colors = c(red = "#f34213", purple = "#3e2f5b", orange = "#ff8811", 
             green = "#136f63", white = "#FFFFFF", base = "#1c5253",
             gray = "#708090", salmon = "#ff8c69", indianred = "#cd5c5c"),
  link_color = "steelblue",
  #header_font_google = google_font("Josefin Sans"),  #- https://fonts.google.com/
  #text_font_google   = google_font("Montserrat", "300", "300i"),
  code_font_google   = google_font("Fira Mono"))
```

```{r chunk-setup, include = FALSE}
knitr::opts_chunk$set(echo = TRUE, eval = TRUE, message = FALSE, warning = FALSE,
                      #results = "hold",
                      cache = FALSE, cache.path = "/caches/", comment = "#>",
                      #fig.width = 7, #fig.height= 7,
                      #out.width = 7, out.height = 7,
                      collapse = TRUE,  fig.show = "hold", fig.retina = 4,
                      fig.asp = 7/9, out.width = "95%", fig.align = "center")
options(scipen = 999) #- para quitar la notaci√≥n cient√≠fica
#- para mejorar los gr√°ficos, bueno en realidad para que se vean igual en distintos SO
#- https://www.jumpingrivers.com/blog/r-knitr-markdown-png-pdf-graphics/
knitr::opts_chunk$set(dev = "png", dev.args = list(type = "cairo-png"))
#options(htmltools.dir.version = FALSE) #- lo pongo en setup
#xaringan::inf_mr() 
```

```{r, include = FALSE}
library(flipbookr)
library(tidyverse)
```

```{css, include = FALSE}
.remark-code{line-height: 1.5; font-size: 80%}
@media print {
  .has-continuation {
    display: block;
  }
```


class: inverse, center, middle

<br>

#### `r rmarkdown::metadata$subtitle`

## `r rmarkdown::metadata$title`

<br>

### `r rmarkdown::metadata$author`

#### 2020, septiembre

###### (actualizadas el `r format(Sys.time(), '%d-%m-%Y')`)


<br><br>
  
#### e-mail: [pedro.j.perez@uv.es](mailto:pedro.j.perez@uv.es)
  
#### Web del curso: [https://perezp44.github.io/intro-ds-22-23-web](https://perezp44.github.io/intro-ds-22-23-web)


```{r echo = FALSE}
xaringanExtra::style_share_again(share_buttons = c("twitter", "linkedin", "pocket") )
```





---
class: inverse, center, middle

## R-base (algunas ideas b√°sicas)

<html><div style='float:left'></div><hr color='#EB811B' size=1px width=796px></html>

#### Es muy importante *empezar* a entenderlas

---
##### Veremos conceptos/ideas como

<br>

- asignaci√≥n

- tipos de datos

- estructuras de datos

- funciones

- paquetes: instalaci√≥n y ayuda

<br>


---
class: inverse, center, middle

### Creaci√≥n de objetos (asignaci√≥n)

<html><div style='float:left'></div><hr color='#EB811B' size=1px width=796px></html>

#### En R, la asignaci√≥n se hace, generalmente, con el s√≠mbolo: .large[<-]

---

##### Creaci√≥n de objetos y asignaci√≥n (.large[<-])

- El operador de asignaci√≥n (`<-`) permite asignar datos/valores a variables/objetos. Con la asignaci√≥n se **crean objetos**/variables que despu√©s podremos usar en otras operaciones.

--

- Es mucho m√°s f√°cil explicarlo apoy√°ndose en ejemplos:

```{r, eval = FALSE}
#- ¬øQu√© diferencias hay entre las siguientes 2 expresiones?
2 + 2
aa <- 2 + 2

#- una vez hemos creado una variable, podemos usarla para efectuar nuevos c√°lculos
aa + 1

#- podemos cambiar el valor de una variable
aa
aa <- 10
aa

#- ¬øQu√© hacen las siguientes lineas de c√≥digo? 
aa <- 2 + 2
bb <- 5 + aa
cc <- 1 + aa * 2
dd <- bb
```


---

##### Se que te ha resultado muy f√°cil, pero vuelvo a insistir: 

> En R, la forma gen√©rica de una operaci√≥n de asignaci√≥n, o de ‚Äúcreaci√≥n de objetos‚Äù, es: .white.bg-purple[nombre_del_objeto <- valor] , por ejemplo .white.bg-purple[aa <- 2 + 2]  [ üåü ] [üå∂]

<br>


- Recuerda que para que un nombre sea **sint√°cticamente v√°lido** en R s√≥lo puede contener caracteres alfanum√©ricos (letras y n√∫meros), puntos (.) y guiones bajos (_).

- Adem√°s, hay **nombres reservados** (TRUE, NA, if, while, do , next, for ...)

--

--------------------------

##### Global environment (primera referencia al)

Cada vez que asignamos un nombre a un valor, **R crea un nuevo objeto en el Global environment**. Ve√°moslo:

```{r, eval = FALSE}
aa <- 2 + 2
bb <- 5 + aa
cc <- 1 + aa * 2
dd <- bb

ls()              #- muestra los objetos q hay en el  Global env. 
rm(cc)            #- borra/elimina el objeto cc del Global env.
rm(list = ls())   #- borra todos los objetos del Global env.
```


---
class: inverse, center, middle

### Tipos de datos

<html><div style='float:left'></div><hr color='#EB811B' size=1px width=796px></html>

#### num√©ricos (enteros y doubles), l√≥gicos y textuales

---

##### Tipos de datos

- Hay **3 tipos principales**: num√©ricos, de texto y l√≥gicos, pero en realidad R tiene 6 tipos de datos. 

- Adem√°s, hay 4 valores especiales: NULL, NA, NaN, e infinito

- Cada dato, valor o variable es de un tipo. 

```{r, eval = FALSE}
aa <- "La calle en la que vivo es"    #- texto (character)
bb <- 4L                              #- n√∫mero entero
cc <- 4.3                             #- n√∫mero decimal
dd <- TRUE                            #- logical

typeof(aa)
typeof(dd)
```

<br>

- **IMPORTANTE** [ üåü ]: El tipo de una variable determina las operaciones que se pueden hacer con √©l.

---

##### Operaciones con variables num√©ricas

- Operaciones aritm√©ticas

```{r, eval = FALSE}
2 + 2
5 * 6
```

--

- Operaciones de comparaci√≥n

```{r, eval = FALSE}
2 < 4    # MENOR que: esta expresi√≥n chequea si 2 es MENOR que cuatro. Como es cierto, nos devuelve un TRUE

2 > 4    # MAYOR que: esta expresi√≥n chequea si 2 es MAYOR que cuatro. Como es falso, nos devuelve un FALSE

5 >= 7   # MAYOR o IGUAL que.
8 <= 8   # MENOR o IGUAL que.

5 == 4  # == IGUAL: == chequea si dos valores son iguales, como no son iguales devolver√° FALSE

2 != 4   # NO IGUAL: como 2 no es igual a 4 nos devuelve TRUE
5 != 5   # NO IGUAL: como 5 es igual a 5, nos devuelve FALSE 
```


- F√≠jate que las expresiones de comparaci√≥n al ser ejecutadas **devuelven un ‚Äúboolean‚Äù**: el resultado de la comparaci√≥n solo puede ser TRUE (si la afirmaci√≥n es cierta) o FALSE.


```{r, eval = FALSE}
2 = 2    #- ¬øqu√© ocurre? ¬øxq se queja R?
```

---

##### Operaciones con texto

- En R hay muchas funciones para trabajar/operar sobre texto

- Por ejemplo, la funci√≥n `paste()` nos permite pegar o concatenar dos variables de tipo character:


```{r, eval = FALSE}
aa <- "mi nombre es"
bb <- "pedro"

paste(aa, bb)

paste(aa, bb, sep = " ... ")

# Prueba t√∫ mismo qu√© hace la funci√≥n paste0()
```



```{r, eval = FALSE}
toupper(aa)
tolower(aa)

stringr::str_to_sentence(aa)   #- stringr es un pkg del tidyverse

nchar(bb)                      #- nchar() nos devuelve el n√∫mero de caracteres de un string

substring(bb, 2, nchar(bb))    #- substring() extrae caracteres de un string  [üå∂üå∂]
```


---

##### Operaciones l√≥gicas

- Los 3 principales operadores l√≥gicos son: ( **&** ), ( **|**) y ( **!** ). Son los operadores l√≥gicos **AND**, **OR** y **NOT**

```{r, eval = FALSE}
TRUE & TRUE    #- AND: para q devuelva TRUE hace falta que TODAS las condiciones sean ciertas
TRUE & FALSE
FALSE & FALSE

TRUE | TRUE   #- OR: devuelve TRUE si ALGUNA de las condiciones es cierta
TRUE | FALSE
FALSE | FALSE

!TRUE         #- NOT: devuelve el valor contrario
!FALSE
```




```{r, eval = FALSE}
(4 > 3) & (3 < 2)  #- AND: como solo se cumple la primera condici√≥n, nos devuelve FALSE

(1==2) | (2 >3)   #- OR: Como no se cumple ninguna de las 2 condiciones nos devuelve FALSE

!(4 > 3)          #- NOT: 4 es mayor que 3 es TRUE, pero el ! delante de esa condici√≥n la niega y pasa a FALSE

!!(4 > 3)         #- si niegas dos veces, vuelves al principio: TRUE

```


- Hay m√°s operadores l√≥gicos, por ejemplo: **xor()**, **all()**, **any()**, **&&** y **||** , pero es f√°cil que no los usemos ,y si los usamos ya los veremos.



---
class: inverse, center, middle

## Estructuras de datos 

<html><div style='float:left'></div><hr color='#EB811B' size=1px width=796px></html>

#### Es muy importante!!! [ üåü ] pero en realidad para el curso basta con una "ligera" idea, porque trabajaremos (casi siempre) con una sola estructura de datos: los *data.frame*


---

##### Estructuras de datos

R sirve para hacer an√°lisis estad√≠sticos con datos, y los datos tienen que estar almacenados en alguna estructura. Las **principales estructuras de datos en R** son:

  - vectores

  - matrices

  - arrays (matrices multidimensionales)

  - listas

  - **data.frames**

--------------------------------

--

- Las que **m√°s utilizaremos** en el curso son los **data.frames**, y en segundo lugar las listas. 

- Si, **pero** en realidad estas 2 estructuras (data.frames y listas) son en realidad agrupaciones de vectores; es decir, **la estructura b√°sica, la m√°s importante en R son los vectores**. 

- Son los m√°s importantes porque el resto de estructuras se construyen a partir de grupos de vectores o a√±adiendo alguna propiedad adicional, o atributo, a un vector.



---
class: inverse, center, middle

## VECTORES

<html><div style='float:left'></div><hr color='#EB811B' size=1px width=796px></html>

#### No los utilizaremos mucho-mucho, pero es la estructura de datos fundamental


---

##### Vectores

- La estructura de datos fundamental en R es el vector. 

- En R, un vector es una estructura de datos que sirve para almacenar un conjunto ordenado de valores o elementos. 

- Un vector puede contener cualquier n√∫mero de elementos; sin embargo, **todos los elementos deben ser del mismo tipo**. Por ejemplo, un vector no puede contener simult√°neamente n√∫meros y texto.

---

##### ¬øC√≥mo crear un vector?

- Con la funci√≥n .white.bg-purple[c()]

```{r, eval = FALSE}
aa <- c(3, 22, 6)
aa
is.vector(aa)
typeof(aa)
```

<br>

--

.panelset[
.panel[.panel-name[Tarea]

.white.bg-green[Tarea]: crea un vector de tipo character con 3 elementos

]

.panel[.panel-name[Soluci√≥n]

```{r, eval = FALSE}
aa <- c("Hola", "n√∫mero", "9")

is.vector(aa)
typeof(aa)
```


]
]

---

##### Coerci√≥n (implicita)

- Sabemos que un vector solo puede contener elementos de un tipo (es una **estructura homog√©nea**)

- ¬øQu√© ocurre si intentamos mezclar en un vector elementos de distinto tipo? R convertir√° (coercer√°) los elementos para que sean del mismo tipo

```{r, eval = FALSE}
aa <- c(4, 6,  "Hola")  #- intentamos poner en aa elementos num√©ricos y character (¬ø?)

is.vector(aa)
typeof(aa)       #- ¬øqu√© ha pasado?
aa               #- ¬øqu√© ha pasado?
```


- R convertir√° todos los elementos al tipo m√°s flexible: **`character > double > integer > logical`**. Por ejemplo, si en el vector hay un valor textual, todos los valores se convertir√°n al tipo character.

--

##### Coerci√≥n (explicita)

- A veces tendremos un vector de un tipo, por ejemplo num√©rico, pero nos gustar√≠a convertirlo a por ejemplo character.

```{r, eval = FALSE}
aa <- c(1:4)
aa
aa <- as.character(aa)
aa
```

---

##### Subsetting con vectores

- En R podemos agrupar valores en vectores. Perfecto, pero habr√° veces que necesitemos **manipular los vectores**. Por ejemplo necesitaremos acceder a determinados elementos de un vector. Este tipo de operaciones sobre los vectores se les conoce gen√©ricamente como **subsetting**.

- Para hacer subsetting se usan los **corchetes**:  **`[]`**

- Vemos **3 tipos de subsetting**

--

---

##### 3 tipos de subsetting

###### 1. Seleccionar por posici√≥n

```{r, eval = FALSE}
aa <- c(10:1)
aa[c(1:2)]        #- primer y segundo elemento del vector

aa[c(1, 2, 9, 10)]   #- dos primeros y 2 √∫ltimos

aa[c(1, 1, 10, 10)]  #- si repites el indice se repite el elemento del vector
```
  
--
 
###### 2. Eliminar por posici√≥n
  
```{r, eval = FALSE}
aa <- c(10:1)
aa[-2]

aa[- c(1, 2, 9:10)]
```
  
--

###### 3. Subsetting l√≥gico


```{r, eval = FALSE}
aa <- 1:10
aa[aa >= 7]
aa[aa < 4]

aa[(aa >= 9) | (aa < 2)]
aa[(aa >= 9) & (aa < 2)]
```

---

##### Intenta entender bien el siguiente chunk. Es importante!!
  
```{r, eval = FALSE}
aa <- 1:10
aa <= 4
aa[aa <= 4]
aa <- aa[aa <= 4]
aa
```
  
--

##### Modificando elementos de un vector

```{r, eval = FALSE}
aa <- c(1:10)
aa[4] <- 88             #- el cuarto elemento de aa tomar√° el valor 88
aa <- c(aa, 111, 112)   #- a√±adimos 2 elementos al vector aa
```

--

##### Los vectores se pueden concatenar

```{r, eval = FALSE}
aa <- c(1:5)
bb <- c(100:105)
cc <- c(aa, bb)
```

---

##### Operaciones con vectores

- Generalmente son operaciones elemento a elemento

```{r, eval = FALSE}
aa <- 1:10
bb <- 1:10
aa + bb
aa * bb
```

- Si quieres hacer √°lgebra matricial son otros operadores

```{r, eval = FALSE}
aa  %*% bb
```

<br>
 
--

--------------------------------------------------

#####  Recycling

```{r, eval = FALSE}
aa <- 1:10
aa + 1
```

---


##### Funciones vectorizadas

- La mayor√≠a de funciones, y todos los operadores de R est√°n vectorizados; es decir, si una funci√≥n recibe como input un vector, se aplicar√° la funci√≥n a cada uno de los elementos del vector.


```{r, eval = FALSE}
aa <- c(4, 9, 25)
sqrt(aa)
```

-----------------------------

--

##### Operaciones de comparaci√≥n

```{r, eval = FALSE}
aa <- 1:3
bb <- 3:1

aa == bb
aa >= bb
aa != bb
```


- En las operaciones de comparaci√≥n tambi√©n aplica el Recycling

```{r, eval = FALSE}
aa <- 1:3
bb <- 2

aa == bb
aa >= bb
aa != bb
```


---
class: inverse, center, middle

## LISTAS 

<html><div style='float:left'></div><hr color='#EB811B' size=1px width=796px></html>

#### No las utilizaremos demasiado, pero ...


---

##### Lists

- Esta estructura de datos, aunque en realidad se construye por **agrupaci√≥n de vectores**, s√≠ que se comporta de forma diferente a los vectores. 


- Las listas son una estructura de datos heterog√©nea: s√≠ **pueden contener elementos de distinto tipo**.

- La mejor forma de entender como funciona una lista es pensar que es como una cajonera. En cada caj√≥n podemos poner objetos de diferentes tipos.

--

--------------------------

- Vamos a crear una lista. Se hace con `list()`

```{r, eval = FALSE}
# defino 3 vectores y una matriz
vec_numerico <- c(1:8)
vec_character <- c("Pedro", "Rebeca", "Susana")
vec_logic <- c(TRUE, FALSE, TRUE)
matriz <- matrix(1:6, nrow = 2, ncol = 3)

# creo una lista con cuatro elementos
my_list <- list(vec_numerico, vec_character, vec_logic, matriz)
my_list
```


---

##### m√°s cosas sobre las listas

- Las listas son **sumamente flexibles** porque un elemento de una lista puede ser otra lista.


- Como son tan flexibles, se usan para muchas cosas, por ejemplo para almacenar los resultados de la estimaci√≥n de modelos estad√≠sticos. (por ejemplo, los gr√°ficos de ggplot internamente son listas)

--

- Un ejemplo:

```{r, eval = FALSE}
my_list_2 <- list(primer_slot = c(44:47), segundo_slot = my_list)
my_list_2
```

<br>


--

--------------------------------------

##### Subsetting con listas

- Ya lo veremos cuando lo necesitemos!!


---
class: inverse, center, middle

## DATA FRAMES 

<html><div style='float:left'></div><hr color='#EB811B' size=1px width=796px></html>

#### Estaremos todos el curso trabajando con DATA FRAMES


---

##### DATA FRAME's

-  Son otra **estructura de R para almacenar datos**. Se utiliza para almacenar datos tabulares, tablas de datos

- En el fondo, un data.frame es una lista. Al ser una lista **puede almacenar elementos de distinto tipo** (num√©ricos, car√°cter etc‚Ä¶). 


- PERO es una **lista especial**: est√° restringida a que sus elementos/slots son vectores con la misma longitud; de forma que, al final tenemos una tabla de datos, donde **cada columna ser√° una variable**

- Otra propiedad de los data.frames es que sus vectores (o columnas)  tienen que tener un nombre: ser√° el nombre de la variable.


---

##### Creaci√≥n de data frame's

- Generalmente no crearemos data.frames sino que los importaremos de repositorios de datos, por ejemplo de Eurostat o del INE, pero hoy vamos a crear uno con la funci√≥n **`data.frame()`**

```{r, eval = FALSE}
aa <- c(4, 8, 6, 3)
bb <- c("Juan", "Paz", "Adrian", "Marquitos")
cc <- c(FALSE, TRUE, TRUE, FALSE)

df <- data.frame(aa, bb, cc)
```

--

<br>

- Podemos ponerle otros nombres a las columnas, nombres que tengan sentido y que nos recuerden las variables que contienen:

```{r, eval = FALSE}
df <- data.frame(Nota = aa, Nombre = bb, Aprobado = cc)
```


---

##### Subsetting en data frames

Generalmente, cuando tengamos que hacer subsetting en un data frame, lo haremos **√† la tidyverse**, pero conviene al menos conocer lo b√°sico de como hacer subsetting con R-base.

Varias formas de subsetting:

- como si fuera una matriz, usando el corchete; o sea,  **con [**.

- como si fuera una lista. De hecho un df es una clase especial de lista. **Podemos usar 3 operadores: [, [[ y $**.


<br>

------------------------------

--

##### subsetting como si fuera matriz (con [ )


```{r, eval = FALSE}
df_s <- df[,1]        #- seleccionamos la primera columna. devuelve un vector !!!
df_s <- df[,c(2,3)]   #- seleccionamos la segunda y tercera columna. devuelve un df
df_s <- df[1, ]       #- seleccionamos primera fila de todas las variables. devuelve un df. ¬øxq no devuelve un vector? Preguntad si no lo sab√©is
df_s <- df[c(1,4), ]  #- seleccionamos primera y cuarta fila. devuelve un df
df_s <- df[2, 3]      #- seleccionamos segunda observaci√≥n de la tercera variable. Devuelve un vector.
```


---

##### data.frames: subsetting como si fuera una lista (con [, [[, $)


#### Como lista con [

- siempre devuelve un df


```{r, eval = FALSE}
df_s <- df[3]        #- devuelve un df. Good!!
df_s <- df[c(1,2)]

#- tambi√©n se puede hacer por nombre
df_s <- df["Name"]                #- devuelve un df
df_s <- df[c("Name", "Grade")]   
```

--

#### Como lista con [[


```{r, eval = FALSE}
df_s <- df[[2]]   #- Extraemos la segunda columna. Devuelve un vector, concretamente un factor. Ahhhh!!!!!
```

--

#### Como lista con $


```{r, eval = FALSE}
df_s <- df$Name   #- Extraemos la columna con nombre "Name". Devuelve un vector, concretamente un factor. Ahhhh!!!!!
df_s <- df$Grade  #- Extraemos la columna con nombre "Grade". Devuelve un vector num√©rico
```


---
class: inverse, center, middle

# FUNCIONES  

<html><div style='float:left'></div><hr color='#EB811B' size=1px width=796px></html>

#### Quiz√°s lo m√°s importante del curso sea entender bien c√≥mo "funciona" una funci√≥n

---

##### Entender qu√© es una funci√≥n y ...

##### ... c√≥mo ‚Äúfunciona una funci√≥n‚Äù es muuuuy importante!!!

- Repito, es muy importante entender qu√© es y c√≥mo usar una funci√≥n. De hecho, todo lo que ocurre/pasa en R es porque has llamado a una funci√≥n. Si algo ocurre en R es porque has hecho una llamada a una funci√≥n, una ‚Äúfunction call‚Äù.

>  To understand computations in R, two slogans are helpful:  
>     - Everything that exists is an object.  
>     - Everything that happens is a function call.  
>   ‚Äî John Chambers  (creador de S)

-----------------------------------

--

- **¬øQu√© es una funci√≥n?** Una funci√≥n no es m√°s un trozo de c√≥digo R, unas instrucciones de R, a las que les hemos puesto/asignado un nombre; entonces, cuando invoquemos ese nombre, esa funci√≥n, se ejecutar√°n esas lineas de c√≥digo. (!!!)

- Como no creo que lo anterior os diga mucho, voy a usar 5 minutos para crear nuestra primera funci√≥n. Vamos a R.

---

##### Creamos nuestra primera funci√≥n [üå∂üå∂üå∂]


.panelset[
.panel[.panel-name[Tarea]

.white.bg-green[Tarea]: crea una funci√≥n que permita sumar 2 n√∫meros

]

.panel[.panel-name[Pistas]

**Pista**: Las funciones en R se crean con la funci√≥n llamada `function()`. S√≠, un poco trabalenguas.

**Pista**: La funci√≥n que vamos a crear ser√° un objeto de R, as√≠ que le tenemos que asignar un nombre

**Pista**: Los argumentos de la funci√≥n van dentro de los parentesis separados por comas

**Pista**: El c√≥digo que queramos que se ejecute cuando llamemos a la funci√≥n va entre llaves

Por lo tanto, en gen√©rico, una funci√≥n en R se crea as√≠:

```
nombre_de_mi_funcion <- function(primer_argumento, segundo_argumento, ...) {
  <el-codigo-q-quiero-q-se-ejecute-cuando-se-invoque-a-la-funci√≥n>
}
```


S√≠ lo consegu√≠s sois genios o ya hab√©is visto esto en otro lenguaje


]
.panel[.panel-name[Soluci√≥n]

```{r, eval = FALSE}
#- creamos una funci√≥n llamada "my_suma()". Lo hacemos con la funci√≥n de R llamada "function()"
my_suma <- function(n1 , n2){
  n1 + n2
}

#- para usar la funci√≥n que hemos creado
my_suma(3 , 5)
my_suma(n1 = 3 , n2 = 5)

aa <- my_suma(30 , 50)
```

]
]

--

<br><br><br>

##### entiendes mejor ahora qu√© es una funci√≥n?

- Tras haber creado nuestra primera funci√≥n, yo creo que ahora entender√°s mejor que una funci√≥n no es m√°s que un trozo de instrucciones/c√≥digo en R que alguien ha creado para ser usada. Solo tenemos que invocar su nombre y dar valores a sus argumentos.


---

##### seguimos con las funciones


- Vamos a profundizar en nuestro conocimiento de las funciones usando una: usando la funci√≥n `sqrt()`. Resulta que alguien se ha preocupado de construir una funci√≥n llamada `sqrt()` que sirve para calcular ra√≠ces cuadradas. Vamos a usarla!! C√≥mo??

---------------------------

--

##### saber consultar la ayuda de una funci√≥n is VERY important [ üåü ]

- Para saber como usar una funci√≥n lo que hay que hacer es **consultar la ayuda de la funci√≥n**; s√≠ cada funci√≥n de R tiene una p√°gina de ayuda interna. 

- Para abrir la ayuda de una funci√≥n tienes que situar el cursor en el nombre de la funci√≥n y pinchar en .white.bg-purple[F1]. Tambi√©n puedes hacer:

```{r, eval = FALSE}
help(sqrt)
```

- Pufff!!! la ayuda de la funci√≥n parece muy complicada. S√≠, eso parece: hay que aprender a leer las ayudas de las funciones. **Esto es MUY IMPORTANTE!!!!** si quieres aprender a manejarte con R. Enseguida lo vemos

---

##### seguimos con las funciones 

- Aunque no lo entiendas del todo, tienes que saber que, cuando vamos a usar una funci√≥n, su estructura es:  .white.bg-purple[nombre_de_la_funcion(argumento_1, argumento_2, ....) ] . Luego volveremos a este punto.

<br>

- .white.bg-green[Tarea:]Ejecuta estas instrucciones e intenta entender que ocurre.

```{r, eval = FALSE}
sqrt(9)
sqrt(9, 4)   #- no funciona ¬øpor qu√©? ¬øcuantos argumentos tiene la f. sqrt()?
sqrt("9")    #- no funciona, ¬øpor qu√©? ¬øC√≥mo, de que tipo, ha de ser el argumento?
```

<br>

---

##### seguimos con las funciones (m√°s detalles) [üå∂üå∂üå∂]

- En realidad, cuando vamos a usar una funci√≥n, **cada argumento de la funci√≥n tiene 2 elementos**: el **nombre** del argumento y un **valor** para el argumento
  
```
nombre_de_la_funcion(name_argumento_1 = valor_1, name_argumento_2 = valor_2, ....)
```

- El nombre de la funci√≥n sqrt() es `sqrt`, ok, pero ¬øcuales son sus argumentos? La ayuda nos dice que s√≥lo tiene un argumento, cuyo nombre es x; adem√°s, el valor del argumento debe ser num√©rico. (!!!). 


```{r, eval = FALSE}
sqrt(9)       #- en realidad "no hace falta" poner el nombre del argumento
sqrt(x = 9)   #- 
sqrt(x = 4)
```

--

--------------------------

- Vamos a aprender a diferenciar el nombre y el valor del argumento de una funci√≥n:

```{r, eval = FALSE}
sqrt(9)
sqrt(x = 9)

x <- 25
sqrt(x)

sqrt(x = x)          #- !!!
sqrt(x = un_valor)   #- !!!
sqrt(nn = 9)         #- !!!
```


---

##### seguimos con las funciones (ya cas√≠ lo tenemos!!)


- .white.bg-green[Tarea:] calculad con R el logaritmo de 1000 en base 10.  

    Para ello ten√©is que usar la funci√≥n log(), y c√≥mo no sab√©is c√≥mo se usa, no sab√©is c√≥mo es su sintaxis, no sab√©is cuales son sus argumentos, os tocar√° **mirar la ayuda de la funci√≥n**.
    

--

.panelset[
.panel[.panel-name[Tarea]
    
- Venga, que os ayudo: `log(1000)` no va a funcionar. ¬øPor qu√©? para saberlo tendr√°s que mirar la ayuda de la funci√≥n `log()`

```{r, eval = FALSE}
help(log)
```
]

.panel[.panel-name[Soluci√≥n]


```{r, echo = TRUE, eval = FALSE}
log(1000)  #- como no especificamos el valor del argumento "base",
           #- R lo fija a su valor x defecto; es decir, base = exp(1) 
           #- as√≠ que estamos tomando logaritmos naturales
```


```{r, echo = TRUE, eval = FALSE}
log(x = 1000, base = 10)    #- GOOD

log(1000, base = 10)        #- es equivalente
log(x = 1000, 10)           #- es equivalente
log(1000, 10)               #- es equivalente

log(1000, bas = 10)         #- funciona, pero ...
```

¬øPor qu√© no podemos usar la expresi√≥n de abajo?

```{r, eval = FALSE}
log(10, 1000)
```


```{r, eval = FALSE}
log(base = 10, 1000)
```

]
]

---

##### Para finalizar (de momento) con las funciones, 3 cosas:

- Leeros el **ap√©ndice A.1.1** del libro [Data Visualization
A practical introduction](https://socviz.co/index.html#preface) de Kieran Healy. El ap√©ndice est√° (aqu√≠)[https://socviz.co/appendix.html#a-little-more-about-r], y se llama **"How to read an R help page"**. 


--

------------------

- En casa, pod√©is **ver [[este video]](https://www.youtube.com/watch?v=pXA350-o0v8)**: en √©l nos cuentan que, cuando creas una funci√≥n, su estructura general es:


  ```{r, eval = FALSE}
    function_name <- function(my_args) {
    # process the arguments
    # return some value
    }
  ```

--


Por ejemplo, podr√≠amos crear una funci√≥n para sumar 1 a un n√∫mero:

```{r, eval = FALSE}
add1 <- function(my_number) {
  my_number + 1
}
```

--

--------------------------

- Para finalizar de verdad con las funciones, ten√©is una **nueva tarea**: cread una funci√≥n que sume tres n√∫meros (!!)



---

##### venga a hacer la tarea para finalizar con las funciones!! [üå∂üå∂üå∂üå∂]

.panelset[
.panel[.panel-name[Tarea 1]
    
- Os recuerdo la **tarea:** ten√©is que crear una **funci√≥n que sume 3 n√∫meros**

- Venga, que os ayudo: Hay que utilizar la f. llamada `function()` y poner entre llaves el c√≥digo que quieres que implemente la funci√≥n.  

- Recuerda que has de poner un nombre a tu funci√≥n.   

- Recuerda que has de poner el nombre de los argumentos de tu funci√≥n dentro del par√©ntesis, separados por comas.  Nuestra funci√≥n tendr√° 3 argumentos 
 
 <br>
 
Quedar√° algo as√≠:


```{r, eval = FALSE}
name_of_my_function <- function(<los argumentos van AQUI>){
  #- aqu√≠ tienes que poner el c√≥digo de la funci√≥n
}
```

]

.panel[.panel-name[Soluci√≥n]

Esta vez no hay soluci√≥n.

<br><br><br><br>

```{r, echo = FALSE}
countdown::countdown(minutes = 0, seconds = 45)
```

]

.panel[.panel-name[Tarea 2]

Como ya hemos creado nuestra funci√≥n que suma 3 n√∫meros, vamos a mejorarla un poco: vamos a poner **valores por defecto a los argumentos** (por si alguien se olvida de introducir los valores a nuestra funci√≥n).

  - Por ejemplo que el valor por defecto del primer argumento sea 4, el del segundo que sea 6, y el del tercero que sea 3.

]

.panel[.panel-name[Soluci√≥n 2]

Venga, os doy una soluci√≥n parcial. Solo ten√©is que rellenar los 7 sitios en los que aparece "..."

```{r, eval = FALSE}
... <- function(n1 = ... , ... = 6, ... = ... ){
   ... + n2 + ...
}
```

<br><br><br><br><br><br>

```{r, echo = FALSE}
countdown::countdown(minutes = 0, seconds = 45)
```


]
.panel[.panel-name[NO MIRAR!!]

##### Soluci√≥n a la primera tarea

```{r, eval = FALSE}
my_suma <- function(n1 , n2, n3){
   n1 + n2 + n3
}

#- vamos a usar nuestra funci√≥n
my_suma(2, 2, 2)
my_suma(2)        #- xq no funciona
```


##### Soluci√≥n a la segunda tarea

```{r, eval = FALSE}
my_suma <- function(n1 = 4 , n2 = 6, n2 = 3){
   n1 + n2 + n3
}

#- vamos a usar nuestra funci√≥n
my_suma(2, 2, 2)
my_suma(2)        #- xq ahora s√≠ funciona
```

]

]



---
class: inverse, center, middle

## Paquetes: instalaci√≥n y ayuda

<html><div style='float:left'></div><hr color='#EB811B' size=1px width=796px></html>

#### Es importante entender la diferencia entre paquetes en CRAN y en otros repositorios, y sobre todo, saber buscar la ayuda de un paquete.

---

##### Paquetes (primeras ideas)

<br>

- **¬øQu√© son los paquetes?** trozos/porciones de c√≥digo R que podemos **instalar** en nuestro ordenador

- **¬øQu√© ganamos instalando un paquete?** Los paquetes nos proveen de nuevas funciones o nuevos datos; es decir incrementa la funcionalidad de R: por ejemplo, con el pkg `meme` podemos hacer memes.

<br>

--

- Los paquetes suelen estar en **repositorios**

- R tiene un **repositorio oficial** llamado [**CRAN**](https://cran.r-project.org/). Ahora mismo tiene 16.273 paquetes. [Aqu√≠](https://cran.r-project.org/web/packages/index.html) puedes ver el listado de paquetes ordenados alfab√©ticamente y por fecha, y [aqu√≠](https://cran.r-project.org/web/views/) ordenados por t√≥pico. 

- Hay otros repositorios: Github, Gitlab, Bioconductor, ...

---

##### ¬øC√≥mo me instalo un paquete? (Forma habitual)


- Para instalar un **paquete que est√° en CRAN** hay que usar: 

```{r, eval = FALSE}
install.packages("dplyr")    #- instalamos el pkg dplyr en nuestro ordenador
library(dplyr)               #- cargamos dplyr en memoria de R para as√≠ poder usarlo
```


- Para instalar un **paquete que est√° en GitHub** hay que tener instalado el paquete `remotes` o el paquete `devtools` y hacer: 


```{r, eval = FALSE}
install.packages("remotes")    #- previamente hay que instalar el pkg remotes
remotes::install_github("tidyverse/dplyr")   #- instalamos la versi√≥n de github del pkg dplyr
```


----------------------------

--

- Recuerda que, una vez instalado un paquete, **cada vez que queramos usar ese paquete** hay que cargarlo en memoria con

```{r, eval = FALSE}
library(dplyr)    #- cargamos dplyr en memoria de R para as√≠ poder usarlo
```

- Recuerda que los paquetes se **instalan una sola vez**, pero que cada vez que queramos usarlo hay que "cargarlo" en memoria con `library()`

---

##### Obtener ayuda de un paquete

- Los paquetes que est√°n en CRAN, tienen obligatoriamente un manual en pdf, pero **son mucho m√°s did√°cticas las vignettes** (que no son obligatorias).

- Por ejemplo, el paquete **`dplyr`** est√° en CRAN en [esta direcci√≥n](https://cran.r-project.org/web/packages/dplyr/index.html). Como pod√©is ver tiene un manual en pdf y un listado de vi√±etas.

- Si el paquete tiene vignettes, tambi√©n puedes consultarlas desde RStudio usando cualquiera de las 2 expresiones de abajo: 

```{r, eval = FALSE}
help(package = "dplyr")
browseVignettes("dplyr")
```


--

--------------------

- Generalmente los paquetes, incluso los que est√°n en CRAN, tienen una **versi√≥n de desarrollo en Github**. Por ejemplo, [aqu√≠](https://github.com/tidyverse/dplyr) tienes el link al repo de dplyr en Github. 

- Adem√°s, cada vez es m√°s frecuente que los paquetes tengan una **pagina web propia**. Por ejemplo [aqu√≠](https://dplyr.tidyverse.org/) tienes la pagina web de `dplyr`. Generalmente tienen una secci√≥n llamada "Articles" donde tienes las vignettes.

--

- Aunque la verdad, muchas veces, la forma m√°s r√°pida de aprender a usar un paquete es buscar en Google, y generalmente encuentras un **post** con una buena introducci√≥n al paquete.

---

##### Ejemplo: vamos a buscar ayuda para poder usar el paquete "explore"

.panelset[
.panel[.panel-name[Tarea]

.white.bg-green[Tarea]: imagina que queremos usar el paquete **`explore`** ya que parece que facilita el an√°lisis r√°pido de datos. **Trata de usar este paquete** para analizar un conjunto de datos; p.ej.  el conjunto de datos `iris` o el conjunto de datos `penguins` del paquete `palmerpenguins`.


##### Dialogo ficcional en el aula:

  - *Yo*: S√≠, ya s√© que llevas poco tiempo con R y que no has usado nunca ese paquete...  pero sabes que generalmente los paquetes tienen vignettes y que igual en alg√∫n post describen su uso. Venga a ello!!!

  - *T√∫*:  casi mejor me espero a que lo  hagas t√∫.
  
  - *Yo*: No way!!
  
  - *T√∫*: pero es que estoy cansado, y da pereza, y **no voy  a saber!!**
  
  - *Yo*: Venga a buscar informaci√≥n de ese paquete!! Ni se te ocurra mirar la "soluci√≥n".

]

.panel[.panel-name[Soluci√≥n]

```{r, echo = TRUE, eval = FALSE}
#- post: https://rolkra.github.io/start-to-explore/
#- CRAN: https://cran.r-project.org/web/packages/explore/index.html
#- Github: https://github.com/rolkra/explore

#- install.packages("explore")                 #- instalamos la versi√≥n de CRAN
#- devtools::install_github("rolkra/explore")  #- instalamos la versi√≥n de Github

#- vamos a usar el paquete con el conjunto de datos `iris`
library(explore)
explore(iris)

#- vamos a usar explore para analizar `penguins`
library(palmerpenguins)
library(explore)
explore(penguins)
```

]
]
